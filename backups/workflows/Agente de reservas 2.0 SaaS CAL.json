{"createdAt":"2025-11-24T17:21:48.426Z","updatedAt":"2025-12-05T05:33:22.021Z","id":"odomuCn6Oq3ejL8P","name":"Agente de reservas 2.0 SaaS CAL","active":false,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"=Mensaje del usuario: {{ $('Redis').item.json.response }}\nEl numero de telefono del usuario es:{{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","options":{"systemMessage":"=## 1. DEFINICIÃ“N DE IDENTIDAD\n\nEres un **asistente de reservas** para **Estudio ClÃ­nica Dental**.\n\nTu rol es atender a los clientes respondiendo preguntas frecuentes y gestionando reservas, modificaciones y cancelaciones de citas.\n\n---\n\n## 2. HERRAMIENTAS DISPONIBLES\n\n- **think**\n    \n    Usar esta herramienta SIEMPRE. Resume mentalmente el problema y planifica la respuesta.\n    \n- **conocimiento**\n    \n    Usar siempre para responder cualquier pregunta o duda que tenga el cliente respecto al negocio, horarios, servicios o consultas.\n    \n- **buscar_usuario**:busca al usuario en la base de datos para verificar si esta registrado en el crm.\n- **registrar_usuario**: si el usuario no existe en el CRM debes registrarlo\n- **reservar_cita**\n    \n    Para reservar la cita una vez validada la fecha y hora.\n    \n- **comprobar_fecha**:\nPara comprobar la fecha antes de reservar.\n- **modificar_cita**\n    \n    Para modificar citas agendadas.\n    \n- **cancelar_cita**\n    \n    Para cancelar citas agendadas.\n    \n- **derivar_humano**\n    \n    Para derivar a asesor humano cuando se necesite ayuda extra o el cliente lo requiera.\n    \n\n---\n\n## 3. OBJETIVO PRINCIPAL\n\nEl propÃ³sito principal del agente es **realizar las reservas de manera efectiva**, liberando tiempo a los empleados y asegurando una atenciÃ³n rÃ¡pida y precisa a los clientes.\n\n---\n\n## 4. INSTRUCCIONES ESPECÃFICAS\n\n- Verificar si el usuario existe en el CRM con \"buscar_usuario\".\n- Si el usuario existe preguntale que desea realizar.\n- Si el usuario no existe, preguntale su nombre y apellido y correo electronico y registralo en el CRM con \"registrar_usuario\", luego pregunta que desea realizar.\n- Para **reservar una cita**:\n    - Antes de reservar una cita debes asegurarte de tener el nombre, apellido y correo del usuario. Si falta el correo, pÃ­deselo obligatoriamente.\n    - Pregunta siempre al usuario la **fecha y hora** en que desea su cita.\n    - Es sumamente importante que recibas siempre la FECHA y HORA. Si solo recibes la fecha, pregunta por la hora.\n    - Es obligatorio usar `comprobar_fecha` antes de realizar la reserva.\n    - Si la fecha es vÃ¡lida, utiliza `reservar_cita` para agendarla.\n    - Entrega los datos de la cita agendada,incluir emojis:\n        - ðŸ“… Fecha: (colocar fecha)\n        -ðŸ“ Link meet:(colocar link)\n- Para **modificar una cita**:\n    - Pregunta al usuario la **fecha y hora actual de su cita**.\n    - Pregunta para cuÃ¡ndo desea **cambiar su cita** (nueva fecha y hora).\n    - Es sumamente importante que recibas siempre la FECHA y HORA. Si solo recibes la fecha, pregunta por la hora.\n    -Utiliza `modificar_cita` para proceder con la modificacion.\n    - Entrega los datos de la cita modificada,incluir emojis:\n        - ðŸ“… Fecha nueva cita: (colocar fecha nueva cita)\n        -ðŸ“ Link meet:(colocar link)\n- Para **cancelar una cita**:\n    - Pregunta al usuario la **fecha y hora actual** de la cita que desea cancelar.\n    - Utiliza `cancelar_cita` para proceder con la cancelaciÃ³n.\n- Usa `conocimiento` para responder cualquier duda sobre horarios, servicios, consultas o informaciÃ³n general del negocio.\n- Antes de responder o ejecutar cualquier acciÃ³n, utiliza `think` para organizar y planificar tu respuesta.\n- SÃ© amable, claro y breve en tus respuestas.\n- Para las fechas siempre utilizar el formato ISO con zona horaria de Lima (-05:00)\n- Para **derivar atencion a un asesor**: deriva atencion a un asesor cuando el cliente necesite ayuda extra\n\n## 5. NOTAS IMPORTANTES PARA TI.\n\n- Usa \"think\" siempre antes de actuar\n- Si es un servicio oficial llama a \"conocimiento\" con el nombre exacto\n- Si es una pregunta llama a \"conocimiento\" con la frase textual del cliente\n- Nunca agendes nada sin verificar antes la fecha y sin tener el correo electronico\n- Nunca agendes sin antes recibir la fecha y hora\n- Siempre cierra con una actitud cÃ¡lida, profesional y empÃ¡tica\n- Por favor evita usar ni incluir asteriscos ni comillas.\n- AsegÃºrate de que tu mensaje sea breve y directo, sin usar saltos de lÃ­nea.\n- La fecha de hoy es {{ $now }}\n- Es importante manejar las fechas en formato ISO con zona horaria de Lima (-05:00)\n- -Antes de llamar cualquier herramienta como reservar_cita, modificar_cita, comprobar_fecha o comprobar_disponibilidad, convierte siempre la fecha y hora recibida al formato UTC agregando la zona horaria correcta (America/Lima â†’ -05:00) y produciendo un valor ISO como 2025-12-02T14:00:00-05:00. El usuario siempre darÃ¡ la fecha sin zona horaria, y tÃº debes normalizarla automÃ¡ticamente a UTC \n(zona horaria de Lima, **-05:00)**.\n- Para hacer las reservas siempre debes recibir la fecha y hora soliticada y correo electronico. Si recibes solo la fecha pregunta porfavor que te digan la hora.\n-Si el cliente no se acuerda del horario de su fecha, dale la opcion de derivar a un asesor para ser atendido."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[-1008,-544],"id":"3b6b4564-af0e-48ac-8b1d-78d23508dda9","name":"AI Agent"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[-1168,-224],"id":"6e6403e8-9aac-40a1-aa79-b1a4bce5d7f9","name":"Postgres Chat Memory","credentials":{"postgres":{"id":"H8BZiMyQn9N1EgIv","name":"Postgres account"}}},{"parameters":{"description":"Herramienta para reflexionar y planificar antes de responder. Ãšsala siempre para analizar el contexto, entender la intenciÃ³n del usuario y decidir los prÃ³ximos pasos."},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1,"position":[-1040,-176],"id":"eaccc24b-a269-4232-b972-841a3f812a6e","name":"Think"},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Herramienta para responder a preguntas del usuario.","tableName":{"__rl":true,"value":"documents","mode":"list","cachedResultName":"documents"},"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStoreSupabase","typeVersion":1.3,"position":[-1184,0],"id":"94595c35-9c9b-4a77-8783-88514c59a22d","name":"conocimiento","credentials":{"supabaseApi":{"id":"btYsZzK9vEUB7NIb","name":"Supabase account Fantino"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[-1104,272],"id":"97532287-76de-40fa-af0d-9ec2a82d6986","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"qPtoS3F65dS7YPJZ","name":"OPENAI PRESLA APIKEY"}}},{"parameters":{"description":"LLama a esta tool para realizar las reservas del cliente.","workflowId":{"__rl":true,"value":"D8AaTE8rMGPOtmKd","mode":"list","cachedResultUrl":"/workflow/D8AaTE8rMGPOtmKd","cachedResultName":"reservar_citas_clinicaaaaa CAL"},"workflowInputs":{"mappingMode":"defineBelow","value":{"Fecha":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Fecha', `Fecha en formato ISO con zona horaria, ejemplo:\n2025-12-02T14:00:00-05:00\n`, 'string') }}","Telefono":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","Nombre":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nombre', `Nombre del usuario`, 'string') }}","Correo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Correo', `Correo electronico del usuario`, 'string') }}"},"matchingColumns":["Fecha"],"schema":[{"id":"Fecha","displayName":"Fecha","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Nombre","displayName":"Nombre","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Telefono","displayName":"Telefono","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Correo","displayName":"Correo","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-560,-240],"id":"9fa1297c-48e7-4bc9-ab25-c3e786d829bb","name":"reservar_cita"},{"parameters":{"description":"Herramienta encargada de comprobar las fechas ingresadas","workflowId":{"__rl":true,"value":"UvJdPSxIYNrLBBbz","mode":"list","cachedResultUrl":"/workflow/UvJdPSxIYNrLBBbz","cachedResultName":"comprobar_fecha_clinica CAL"},"workflowInputs":{"mappingMode":"defineBelow","value":{"Fecha":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Fecha', `Fecha en formato ISO con zona horaria, ejemplo:\n2025-12-02T14:00:00-05:00\n`, 'string') }}"},"matchingColumns":["Fecha"],"schema":[{"id":"Fecha","displayName":"Fecha","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-672,-208],"id":"ca5ff53a-8d96-4555-87d6-982ad5dbf002","name":"comprobar_fecha"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"caf542fe-bc18-4389-b681-4bcf16c85bf8","leftValue":"={{ $json.body.message_type }}","rightValue":"incoming","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-4304,-448],"id":"4a3329e2-b20c-42b6-9612-dc64e30d43fe","name":"If1"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-4112,-240],"id":"8f84e558-aab2-4bb6-bcc9-d9113921e832","name":"No Operation, do nothing"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8ab13a4b-c606-48d6-a1f9-23f4fe51c347","leftValue":"={{ $json.body.conversation.messages[0].sender.custom_attributes.bot_off }}","rightValue":"bot off","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-4048,-464],"id":"08935f01-2f0e-4200-8eed-b3caf5172965","name":"If2"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.body.conversation.messages[0].attachments[0].file_type }}","rightValue":"audio","operator":{"type":"string","operation":"equals"},"id":"3d7bf356-e75d-43a7-958e-b731bde14a5f"}],"combinator":"and"},"renameOutput":true,"outputKey":"Audio"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"c44ac4d2-6462-470d-882b-0dbb3db98840","leftValue":"={{ $json.body.conversation.messages[0].attachments[0].file_type }}","rightValue":"image","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Imagen"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d190e0e5-43ac-4a8b-8871-59bd6b2b484e","leftValue":"={{ $json.body.conversation.messages[0].content_type }}","rightValue":"text","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Texto"}]},"options":{"fallbackOutput":"extra","renameFallbackOutput":"Otro"}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-3824,-480],"id":"51b03ef0-f0ab-4097-85dd-b819e561c401","name":"Switch"},{"parameters":{"url":"={{ $json.body.conversation.messages[0].attachments[0].data_url }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-3520,-736],"id":"e03ef82f-aeb3-4163-8bd9-b7a25a4c9792","name":"get audio"},{"parameters":{"url":"={{ $json.body.conversation.messages[0].attachments[0].data_url }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-3504,-528],"id":"c77ae169-6d71-4653-a6d8-92ab4fd041b5","name":"get image"},{"parameters":{"resource":"audio","operation":"transcribe","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-3248,-736],"id":"252ed551-b3c2-408b-b970-81cec36e6404","name":"OpenAI1","credentials":{"openAiApi":{"id":"qPtoS3F65dS7YPJZ","name":"OPENAI PRESLA APIKEY"}}},{"parameters":{"assignments":{"assignments":[{"id":"ab3e1c44-9a2c-48d7-a5d2-41339a74c99e","name":"content","value":"={{ $json.text }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-2992,-736],"id":"5a829c91-d401-4ca1-b263-0136f942f0fe","name":"audio content1"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"chatgpt-4o-latest","mode":"list","cachedResultName":"CHATGPT-4O-LATEST"},"text":"Describe la imagen lo mejor posible.","inputType":"base64","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-3248,-528],"id":"bbc900b2-9417-413f-94b8-715d1e0ee3f7","name":"describe image1","credentials":{"openAiApi":{"id":"qPtoS3F65dS7YPJZ","name":"OPENAI PRESLA APIKEY"}}},{"parameters":{"assignments":{"assignments":[{"id":"ab3e1c44-9a2c-48d7-a5d2-41339a74c99e","name":"content","value":"={{ $json.content }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-2960,-528],"id":"5f9d1fdc-a163-48b0-b962-468f0bf32f4b","name":"imagen content1"},{"parameters":{"assignments":{"assignments":[{"id":"167b012f-c39d-456c-be8e-6e26462ef70e","name":"content","value":"={{ $json.body.content }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-3248,-288],"id":"2be5c6fd-0c69-423c-a8da-c15bf2656e04","name":"text content1"},{"parameters":{"operation":"delete","key":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1232,-544],"id":"1725f698-ea69-47fc-9d14-c20451d79b01","name":"Redis","credentials":{"redis":{"id":"LPbWxLRrzlCEphig","name":"Redis DB"}}},{"parameters":{"assignments":{"assignments":[{"id":"d5f82380-4858-4361-908e-98e45c98f092","name":"response","value":"={{ $('Redis10').item.json.mensajes.join() }}","type":"string"},{"id":"b3db797c-6f2b-4232-8e0c-021bc8e299ca","name":"phone","value":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1424,-544],"id":"4fae53b0-68dc-4f6e-b24a-99c3a7d9d181","name":"Edit Fields"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1488,-336],"id":"0a6eda7f-baac-48fe-ae09-d8995cf89449","name":"No Operation, do nothing2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8a313a41-eadc-4ada-bc2a-feff79845de9","leftValue":"={{ $json.mensajes.last() }}","rightValue":"={{ $('texto final').item.json.chat_input }}","operator":{"type":"string","operation":"equals"}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1680,-528],"id":"5f360956-7d5f-45fa-9e9a-dde22105f101","name":"If"},{"parameters":{"amount":2},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[-2160,-528],"id":"6a9a7875-b9ca-4b42-b70e-3f51efdca810","name":"Wait","webhookId":"91557b89-4edf-41fb-9d24-e69a18da58b9"},{"parameters":{"operation":"push","list":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","messageData":"={{ $json.chat_input }}","tail":true},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-2400,-528],"id":"46c9e567-23f8-4124-a893-2f0418e406d5","name":"Redis8","credentials":{"redis":{"id":"LPbWxLRrzlCEphig","name":"Redis DB"}}},{"parameters":{"operation":"get","propertyName":"mensajes","key":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1904,-528],"id":"3bdbc88a-a23a-4127-af47-579657a66054","name":"Redis10","credentials":{"redis":{"id":"LPbWxLRrzlCEphig","name":"Redis DB"}}},{"parameters":{"method":"POST","url":"=https://inbox2.presla.co/api/v1/accounts/1/conversations/{{ $('Webhook').item.json.body.conversation.messages[0].conversation_id }}/messages","sendHeaders":true,"headerParameters":{"parameters":[{"name":"api_access_token","value":"EKMSYmS4DF9GoVJHQuGbehkh"},{"name":"Content-Type","value":"application/json"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"content","value":"={{ $json.output }}"},{"name":"private","value":"false"},{"name":"message_type","value":"outgoing"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-624,-544],"id":"0ec491b7-cf5e-4239-afba-31efb21fd305","name":"Enviar mensaje chatwoot","executeOnce":false},{"parameters":{"description":"LLama a esta herramienta para modificar citas.","workflowId":{"__rl":true,"value":"4lb4NcuKKNZWlCBH","mode":"list","cachedResultUrl":"/workflow/4lb4NcuKKNZWlCBH","cachedResultName":"modificar_cita_clinica CAL"},"workflowInputs":{"mappingMode":"defineBelow","value":{"Nombre":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.name }}","Telefono":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","Fecha actual":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Fecha_actual', `Fecha actual de la cita en formato ISO con zona horaria, ejemplo:\n2025-12-02T14:00:00-05:00\n`, 'string') }}","Fecha nueva":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Fecha_nueva', `Fecha nueva de la cita en formato ISO con zona horaria, ejemplo:\n2025-12-02T14:00:00-05:00`, 'string') }}","Correo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Correo', `Correo electronico del usuario`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"Fecha actual","displayName":"Fecha actual","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Fecha nueva","displayName":"Fecha nueva","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Nombre","displayName":"Nombre","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Telefono","displayName":"Telefono","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Correo","displayName":"Correo","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-432,-288],"id":"f78710d1-8453-4485-8ff5-449f3d4a474d","name":"modificar_cita"},{"parameters":{"description":"LLama a esta herramienta cuando el cliente requiera atencion extra o quiere ser atendido por un humano.","workflowId":{"__rl":true,"value":"5Rub2Rr4J5UwMEHo","mode":"list","cachedResultUrl":"/workflow/5Rub2Rr4J5UwMEHo","cachedResultName":"enviar_asesor CAL"},"workflowInputs":{"mappingMode":"defineBelow","value":{"conversation id":"={{ $('Webhook').item.json.body.conversation.messages[0].conversation_id }}","contact id":"={{ $('Webhook').item.json.body.conversation.contact_inbox.contact_id }}"},"matchingColumns":[],"schema":[{"id":"conversation id","displayName":"conversation id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"},{"id":"contact id","displayName":"contact id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-208,-432],"id":"b21a3c2d-8450-4ff9-841f-07cb4039a994","name":"enviar_asesor"},{"parameters":{"description":"LLama a esta herramienta para cancelar la cita.","workflowId":{"__rl":true,"value":"zE7xHm4hFzNWT51x","mode":"list","cachedResultUrl":"/workflow/zE7xHm4hFzNWT51x","cachedResultName":"cancelar_cita CAL"},"workflowInputs":{"mappingMode":"defineBelow","value":{"Fecha":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Fecha', `Fecha la cual quiere ser eliminada en formato ISO con zona horaria, ejemplo: 2025-12-02T14:00:00-05:00\n2025-07-09T15:30:00`, 'string') }}","Telefono":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}"},"matchingColumns":[],"schema":[{"id":"Fecha","displayName":"Fecha","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"Telefono","displayName":"Telefono","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[-304,-352],"id":"ed39ee79-d9a9-4589-9281-7c7457992bdb","name":"cancelar_cita"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e4226e1c-d47a-466e-a4d6-0b7bedddbcc5","leftValue":"={{ $json.summary }}","rightValue":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[-2352,320],"id":"cb99b110-87f3-4cf5-a639-3909798dc3f2","name":"Obtener ID"},{"parameters":{"operation":"update","calendar":{"__rl":true,"value":"iacondiegov@gmail.com","mode":"list","cachedResultName":"iacondiegov@gmail.com"},"eventId":"={{ $json.id }}","updateFields":{"summary":"=ðŸŸ¢{{ $json.summary }}"}},"type":"n8n-nodes-base.googleCalendar","typeVersion":1.3,"position":[-2128,320],"id":"fb2f36cb-aba7-4437-b447-fd6ab1aceb85","name":"Google Calendar1","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e4226e1c-d47a-466e-a4d6-0b7bedddbcc5","leftValue":"={{ $json.summary }}","rightValue":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[-2320,48],"id":"ee4b73eb-d918-4d6c-aaba-590b21d967ed","name":"Obtener ID1"},{"parameters":{"httpMethod":"POST","path":"278c79be-a574-4e41-8576-841bbcf0e252","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-5280,-448],"id":"c77c3a16-9fe7-41b0-8c33-729b9d270801","name":"Webhook","webhookId":"278c79be-a574-4e41-8576-841bbcf0e252"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.body.content }}","rightValue":"/No podrÃ© asistir","operator":{"type":"string","operation":"equals"},"id":"1709fd6a-25e1-43eb-9ee0-3631a035ea61"}],"combinator":"and"},"renameOutput":true,"outputKey":"Cancela cita"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"7007be59-2587-4754-8da8-34504f5e452c","leftValue":"={{ $json.body.content }}","rightValue":"/Si confirmo cita","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Confirma cita"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-3120,192],"id":"d3380e28-1b74-4a13-a658-a2152e739f4a","name":"Switch1"},{"parameters":{"operation":"getAll","calendar":{"__rl":true,"value":"iacondiegov@gmail.com","mode":"list","cachedResultName":"iacondiegov@gmail.com"},"limit":20,"timeMin":"={{$now}}","timeMax":"={{ $now.plus({ day: 1 }) }}","options":{}},"type":"n8n-nodes-base.googleCalendar","typeVersion":1.3,"position":[-2544,48],"id":"078359a8-9478-41fc-b63b-2205956006d6","name":"Get many events","disabled":true},{"parameters":{"operation":"delete","calendar":{"__rl":true,"value":"iacondiegov@gmail.com","mode":"list","cachedResultName":"iacondiegov@gmail.com"},"eventId":"={{ $json.id }}","options":{}},"type":"n8n-nodes-base.googleCalendar","typeVersion":1.3,"position":[-2112,48],"id":"72c374b3-5967-4bb2-bb1c-1043b6610df5","name":"Delete an event","disabled":true},{"parameters":{"method":"POST","url":"=https://devchatwoot.iacondiego.es/api/v1/accounts/1/conversations/{{ $('Webhook').item.json.body.conversation.messages[0].conversation_id }}/messages","sendHeaders":true,"headerParameters":{"parameters":[{"name":"api_access_token","value":"gCwFAc6nj7kGQMMbfGM1c1rD"},{"name":"Content-Type","value":"application/json"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"content","value":"=Su cita ha sido cancelada, si quiere volver a agendar vuelva a contactarse por este medio, que este muy bien!"},{"name":"private","value":"false"},{"name":"message_type","value":"outgoing"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1904,48],"id":"a327d339-2f19-4301-bf84-fb9461377e5f","name":"Enviar mensaje chatwoot1","executeOnce":false},{"parameters":{"operation":"getAll","calendar":{"__rl":true,"value":"iacondiegov@gmail.com","mode":"list","cachedResultName":"iacondiegov@gmail.com"},"limit":20,"timeMin":"={{ $json.startDate }}","timeMax":"={{ $json.endDate }}","options":{}},"type":"n8n-nodes-base.googleCalendar","typeVersion":1.3,"position":[-2544,320],"id":"195c6dee-bc6f-4acf-b6ea-183c212475c2","name":"Get many events1","disabled":true},{"parameters":{"method":"POST","url":"=https://devchatwoot.iacondiego.es/api/v1/accounts/1/conversations/{{ $('Webhook').item.json.body.conversation.messages[0].conversation_id }}/messages","sendHeaders":true,"headerParameters":{"parameters":[{"name":"api_access_token","value":"gCwFAc6nj7kGQMMbfGM1c1rD"},{"name":"Content-Type","value":"application/json"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"content","value":"=Perfecto lo esperamos maÃ±ana, nos vemosðŸ˜‰"},{"name":"private","value":"false"},{"name":"message_type","value":"outgoing"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1920,320],"id":"fad86e19-b612-4001-88c9-9f10af3dc613","name":"Enviar mensaje chatwoot2","executeOnce":false},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"016a0aef-07ec-4825-9667-67878457542b","leftValue":"={{ $json.body.conversation.messages[0].content }}","rightValue":"/No podrÃ© asistir","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"e5956087-0d17-4f44-a2c0-aa5911a931b0","leftValue":"={{ $json.body.conversation.messages[0].content }}","rightValue":"/Si confirmo cita","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-3504,-304],"id":"f33ffc43-7df4-413f-a5f8-7e3e462865fa","name":"Confirmacion de citas"},{"parameters":{"assignments":{"assignments":[{"id":"a30bf65d-3d1a-42ef-bfe6-d03e02b86638","name":"chat_input","value":"={{ $json.content }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-2608,-528],"id":"13b91449-1273-45ef-92bd-a0fec40f3cf8","name":"texto final"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-1280,-240],"id":"f4322d52-aed2-47cc-96dc-a16c19e54de2","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"qPtoS3F65dS7YPJZ","name":"OPENAI PRESLA APIKEY"}}},{"parameters":{"operation":"search","base":{"__rl":true,"value":"appqJTfOiskkbXITf","mode":"list","cachedResultName":"Agente de Citas 2.0","cachedResultUrl":"https://airtable.com/appqJTfOiskkbXITf"},"table":{"__rl":true,"value":"tblRml1gWdpw8tVra","mode":"list","cachedResultName":"Clientes","cachedResultUrl":"https://airtable.com/appqJTfOiskkbXITf/tblRml1gWdpw8tVra"},"filterByFormula":"={Telefono}=\"{{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}\"","options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-896,-176],"id":"9fb68685-926f-4a89-8d16-f83aa2ea8b8f","name":"buscar_usuario","credentials":{"airtableTokenApi":{"id":"koP0UPsgGTHwpHeE","name":"Airtable Personal Access Token account"}}},{"parameters":{"operation":"create","base":{"__rl":true,"value":"appqJTfOiskkbXITf","mode":"list","cachedResultName":"Agente de Citas 2.0","cachedResultUrl":"https://airtable.com/appqJTfOiskkbXITf"},"table":{"__rl":true,"value":"tblRml1gWdpw8tVra","mode":"list","cachedResultName":"Clientes","cachedResultUrl":"https://airtable.com/appqJTfOiskkbXITf/tblRml1gWdpw8tVra"},"columns":{"mappingMode":"defineBelow","value":{"Nombre":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nombre', `Nombre del cliente`, 'string') }}","Telefono":"={{ $('Webhook').item.json.body.conversation.messages[0].sender.phone_number }}","Correo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Correo', `Correo del cliente`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"ID Cliente","displayName":"ID Cliente","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":true,"removed":true},{"id":"Nombre","displayName":"Nombre","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Telefono","displayName":"Telefono","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha de Registro","displayName":"Fecha de Registro","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":true,"removed":true},{"id":"Correo","displayName":"Correo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-784,-176],"id":"a6f97ef3-b84b-46f3-b746-e1fcab4e524d","name":"registrar_usuario","credentials":{"airtableTokenApi":{"id":"koP0UPsgGTHwpHeE","name":"Airtable Personal Access Token account"}}},{"parameters":{"jsCode":"const item = $input.first();\nconst inputDate = item.json.formattedDate.trim();   // \"22/04/2025\"\n\n// --- 1. Parsear la fecha DD/MM/YYYY -----------------------------\nconst [day, month, year] = inputDate.split('/').map(Number); // â†’ [22, 4, 2025]\n\n// --- 2. Construir un Date y sumarle 1 dÃ­a -----------------------\nlet base = new Date(year, month - 1, day);          // mes = 0-based\nbase.setDate(base.getDate() + 1);                   // +1 dÃ­a\n\n// --- 3. Helper para devolver ISO sin zona horaria --------------\nconst toISO = (d, hour) => {\n  // Creamos un Date en UTC para la hora pedida\n  const utc = new Date(Date.UTC(\n    d.getFullYear(),\n    d.getMonth(),\n    d.getDate(),\n    hour, 0, 0\n  ));\n  return utc.toISOString().slice(0, 19);            // YYYY-MM-DDTHH:MM:SS\n};\n\n// --- 4. Guardar resultados --------------------------------------\nitem.json.startDate = toISO(base, 8);   // 08:00:00\nitem.json.endDate   = toISO(base, 18);  // 18:00:00\n\nreturn [item];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-2720,48],"id":"4a336fc5-306e-41d0-9616-9b8e299a9e8d","name":"Code"},{"parameters":{"operation":"formatDate","date":"={{ $now }}","format":"custom","customFormat":"dd/MM/yyyy ","options":{}},"type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-2912,48],"id":"e5a1402c-b037-4ceb-b458-f0ac87ad0356","name":"Date & Time"},{"parameters":{"jsCode":"const item = $input.first();\nconst inputDate = item.json.formattedDate.trim();   // \"22/04/2025\"\n\n// --- 1. Parsear la fecha DD/MM/YYYY -----------------------------\nconst [day, month, year] = inputDate.split('/').map(Number); // â†’ [22, 4, 2025]\n\n// --- 2. Construir un Date y sumarle 1 dÃ­a -----------------------\nlet base = new Date(year, month - 1, day);          // mes = 0-based\nbase.setDate(base.getDate() + 1);                   // +1 dÃ­a\n\n// --- 3. Helper para devolver ISO sin zona horaria --------------\nconst toISO = (d, hour) => {\n  // Creamos un Date en UTC para la hora pedida\n  const utc = new Date(Date.UTC(\n    d.getFullYear(),\n    d.getMonth(),\n    d.getDate(),\n    hour, 0, 0\n  ));\n  return utc.toISOString().slice(0, 19);            // YYYY-MM-DDTHH:MM:SS\n};\n\n// --- 4. Guardar resultados --------------------------------------\nitem.json.startDate = toISO(base, 8);   // 08:00:00\nitem.json.endDate   = toISO(base, 18);  // 18:00:00\n\nreturn [item];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-2720,320],"id":"0b9b888c-8b7f-4a5c-9ab8-77c2e18f6986","name":"Code1"},{"parameters":{"operation":"formatDate","date":"={{ $now }}","format":"custom","customFormat":"dd/MM/yyyy ","options":{}},"type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-2912,320],"id":"7f541c5c-b2ed-4e98-9849-da3b73a8bd1f","name":"Date & Time1"},{"parameters":{"operation":"search","base":{"__rl":true,"value":"appqJTfOiskkbXITf","mode":"list","cachedResultName":"Agente de Citas 2.0","cachedResultUrl":"https://airtable.com/appqJTfOiskkbXITf"},"table":{"__rl":true,"value":"tblRml1gWdpw8tVra","mode":"list","cachedResultName":"Clientes","cachedResultUrl":"https://airtable.com/appqJTfOiskkbXITf/tblRml1gWdpw8tVra"},"filterByFormula":"{Telefono}=\"+51950823801\"","options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[-32,-96],"id":"b89ac33f-0690-4ea7-9bf7-111f225c217d","name":"Search records","credentials":{"airtableTokenApi":{"id":"koP0UPsgGTHwpHeE","name":"Airtable Personal Access Token account"}},"disabled":true},{"parameters":{"content":"## Esta anidado al chatwoot de pruebas\n## (inbox2) y credenciales de airtable de fantino","height":176,"width":448},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-816,-896],"id":"14c7a57e-8516-4e0c-a4ac-7610d8cd850a","name":"Sticky Note"},{"parameters":{"content":"## Comprobar fecha âœ…\n## Reservar cita âœ…\n## Modificar cita\n## Cancelar cita\n## Enviar asesor âœ…","height":224,"width":288},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-16,-768],"id":"56cb8e3f-8c84-422b-b85c-09e31fc9351c","name":"Sticky Note1"},{"parameters":{"method":"POST","url":"=https://inbox2.presla.co/api/v1/accounts/{{ $json.body.conversation.messages[0].account_id }}/conversations/{{ $json.body.conversation.messages[0].conversation_id }}/labels ","sendHeaders":true,"headerParameters":{"parameters":[{"name":"api_access_token","value":"EKMSYmS4DF9GoVJHQuGbehkh"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\n  \"labels\": [\n    \"demo-recordatorio\"\n  ]\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-4624,-912],"id":"0c0a498c-bec1-4b4e-88a2-12d8e1ce37e6","name":"HTTP Request1"},{"parameters":{"method":"POST","url":"=https://inbox2.presla.co/api/v1/accounts/{{ $json.body.conversation.messages[0].account_id }}/conversations/{{ $json.body.conversation.messages[0].conversation_id }}/labels ","sendHeaders":true,"headerParameters":{"parameters":[{"name":"api_access_token","value":"EKMSYmS4DF9GoVJHQuGbehkh"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\n  \"labels\": [\n  ]\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-4544,-752],"id":"66d4851a-f7a2-4243-b6fc-28576d6acf94","name":"HTTP Request8"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4265fc3e-69c8-4ced-9312-75527e3a8358","leftValue":"={{ $json.body.conversation.labels[0] }}","rightValue":"demo-cotizacion","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"demo cotizacion activa"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.body.conversation.messages[0].content }}","rightValue":"demo recordatorio on","operator":{"type":"string","operation":"equals"},"id":"1f5a893a-c97a-4b0c-94c4-e812bcdfa6a5"}],"combinator":"and"},"renameOutput":true,"outputKey":"activar flag demo recordatorio"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e909a518-9f3f-4266-9bc7-d38b7eae3f45","leftValue":"={{ $json.body.conversation.messages[0].content }}","rightValue":"demo recordatorio off","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"demo terminada"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"a195611e-b7e6-41c4-abec-ffaa819303eb","leftValue":"={{ $json.body.conversation.labels[0] }}","rightValue":"demo-cotizacion","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"demo recordatorio activo"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"a39b1bb8-0c50-41ba-a18d-955f91b19050","leftValue":"={{ $json.body.conversation.messages[0].content }}","rightValue":"demo cotizaciÃ³n on","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"el otro demo activo"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"beaef124-1f9b-4407-8a56-f09eee0c2e87","leftValue":"={{ $json.body.conversation.messages[0].content }}","rightValue":"demo cotizaciÃ³n on","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"el otro demo activo"}]},"options":{"fallbackOutput":"extra"}},"type":"n8n-nodes-base.switch","typeVersion":3.3,"position":[-5008,-512],"id":"874fce4b-a38a-4433-b70d-1ba92f9afbc9","name":"Switch2"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-4800,-1008],"id":"01293557-73c2-4792-ada0-5045560fb999","name":"No Operation, do nothing3"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-4560,-240],"id":"f1d022f2-3df5-419d-a045-46ec6a868a68","name":"No Operation, do nothing4"}],"connections":{"AI Agent":{"main":[[{"node":"Enviar mensaje chatwoot","type":"main","index":0}]]},"Postgres Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"conocimiento":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"conocimiento","type":"ai_embedding","index":0}]]},"reservar_cita":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"comprobar_fecha":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"If1":{"main":[[{"node":"If2","type":"main","index":0}],[{"node":"No Operation, do nothing","type":"main","index":0}]]},"If2":{"main":[[],[{"node":"Switch","type":"main","index":0}]]},"Switch":{"main":[[{"node":"get audio","type":"main","index":0}],[{"node":"get image","type":"main","index":0}],[{"node":"Confirmacion de citas","type":"main","index":0}]]},"get audio":{"main":[[{"node":"OpenAI1","type":"main","index":0}]]},"get image":{"main":[[{"node":"describe image1","type":"main","index":0}]]},"OpenAI1":{"main":[[{"node":"audio content1","type":"main","index":0}]]},"audio content1":{"main":[[{"node":"texto final","type":"main","index":0}]]},"describe image1":{"main":[[{"node":"imagen content1","type":"main","index":0}]]},"imagen content1":{"main":[[{"node":"texto final","type":"main","index":0}]]},"text content1":{"main":[[{"node":"texto final","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"Redis","type":"main","index":0}]]},"If":{"main":[[{"node":"Edit Fields","type":"main","index":0}],[{"node":"No Operation, do nothing2","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Redis10","type":"main","index":0}]]},"Redis8":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Redis10":{"main":[[{"node":"If","type":"main","index":0}]]},"Redis":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"modificar_cita":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"enviar_asesor":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"cancelar_cita":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Obtener ID":{"main":[[{"node":"Google Calendar1","type":"main","index":0}]]},"Obtener ID1":{"main":[[{"node":"Delete an event","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Switch2","type":"main","index":0}]]},"Switch1":{"main":[[{"node":"Date & Time","type":"main","index":0}],[{"node":"Date & Time1","type":"main","index":0}]]},"Get many events":{"main":[[{"node":"Obtener ID1","type":"main","index":0}]]},"Delete an event":{"main":[[{"node":"Enviar mensaje chatwoot1","type":"main","index":0}]]},"Get many events1":{"main":[[{"node":"Obtener ID","type":"main","index":0}]]},"Google Calendar1":{"main":[[{"node":"Enviar mensaje chatwoot2","type":"main","index":0}]]},"Confirmacion de citas":{"main":[[{"node":"Switch1","type":"main","index":0}],[{"node":"text content1","type":"main","index":0}]]},"texto final":{"main":[[{"node":"Redis8","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"buscar_usuario":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"registrar_usuario":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Code":{"main":[[{"node":"Get many events","type":"main","index":0}]]},"Date & Time":{"main":[[{"node":"Code","type":"main","index":0}]]},"Date & Time1":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Get many events1","type":"main","index":0}]]},"Switch2":{"main":[[{"node":"No Operation, do nothing3","type":"main","index":0}],[{"node":"HTTP Request1","type":"main","index":0}],[{"node":"HTTP Request8","type":"main","index":0}],[{"node":"If1","type":"main","index":0}],[{"node":"No Operation, do nothing4","type":"main","index":0}],[{"node":"No Operation, do nothing4","type":"main","index":0}],[{"node":"If1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"12530f16-b595-48fc-98e9-d785bd0bbc3f","triggerCount":0,"tags":[{"createdAt":"2025-11-24T17:21:44.159Z","updatedAt":"2025-11-24T17:21:44.159Z","id":"N9Ts4rh9w1HwhzNI","name":"Agente de reservas 2.0"},{"createdAt":"2025-11-24T17:21:34.835Z","updatedAt":"2025-11-24T17:21:34.835Z","id":"hJTfClhVd9g7R0a9","name":"CAL"}],"shared":[{"createdAt":"2025-11-24T17:21:48.426Z","updatedAt":"2025-11-24T17:21:48.426Z","role":"workflow:owner","workflowId":"odomuCn6Oq3ejL8P","projectId":"hjSKGjfHqbYgbRJl","project":{"createdAt":"2025-11-20T16:08:16.301Z","updatedAt":"2025-11-20T17:01:47.741Z","id":"hjSKGjfHqbYgbRJl","name":"Presla Corp <svargas@presla.co>","type":"personal","icon":null,"description":null}}]}